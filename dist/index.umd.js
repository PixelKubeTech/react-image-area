(function(R,x){typeof exports=="object"&&typeof module<"u"?x(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],x):x((R=typeof globalThis<"u"?globalThis:R||self)["@bmunozg/react-image-area"]={},R.React)})(this,function(R,x){"use strict";var ae,Q={exports:{}},M={},oe,se,U={};function pe(){return oe||(oe=1,process.env.NODE_ENV!=="production"&&(function(){function r(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===E?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case F:return"Fragment";case K:return"Profiler";case re:return"StrictMode";case T:return"Suspense";case z:return"SuspenseList";case V:return"Activity"}if(typeof e=="object")switch(typeof e.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),e.$$typeof){case te:return"Portal";case ie:return e.displayName||"Context";case ne:return(e._context.displayName||"Context")+".Consumer";case c:var n=e.render;return(e=e.displayName)||(e=(e=n.displayName||n.name||"")!==""?"ForwardRef("+e+")":"ForwardRef"),e;case W:return(n=e.displayName||null)!==null?n:r(e.type)||"Memo";case C:n=e._payload,e=e._init;try{return r(e(n))}catch{}}return null}function d(e){return""+e}function g(e){try{d(e);var n=!1}catch{n=!0}if(n){var i=(n=console).error,t=typeof Symbol=="function"&&Symbol.toStringTag&&e[Symbol.toStringTag]||e.constructor.name||"Object";return i.call(n,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",t),d(e)}}function k(e){if(e===F)return"<>";if(typeof e=="object"&&e!==null&&e.$$typeof===C)return"<...>";try{var n=r(e);return n?"<"+n+">":"<...>"}catch{return"<...>"}}function b(){return Error("react-stack-top-frame")}function j(){var e=r(this.type);return o[e]||(o[e]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),(e=this.props.ref)!==void 0?e:null}function f(e,n,i,t,m,P){var v,h=n.children;if(h!==void 0)if(t)if(H(h)){for(t=0;t<h.length;t++)S(h[t]);Object.freeze&&Object.freeze(h)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else S(h);if(B.call(n,"key")){h=r(e);var w=Object.keys(n).filter(function(p){return p!=="key"});t=0<w.length?"{key: someKey, "+w.join(": ..., ")+": ...}":"{key: someKey}",l[h+t]||(w=0<w.length?"{"+w.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,t,h,w,h),l[h+t]=!0)}if(h=null,i!==void 0&&(g(i),h=""+i),(function(p){if(B.call(p,"key")){var _=Object.getOwnPropertyDescriptor(p,"key").get;if(_&&_.isReactWarning)return!1}return p.key!==void 0})(n)&&(g(n.key),h=""+n.key),"key"in n)for(var X in i={},n)X!=="key"&&(i[X]=n[X]);else i=n;return h&&(function(p,_){function Y(){D||(D=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",_))}Y.isReactWarning=!0,Object.defineProperty(p,"key",{get:Y,configurable:!0})})(i,typeof e=="function"?e.displayName||e.name||"Unknown":e),(function(p,_,Y,a,q,G){var he=Y.ref;return p={$$typeof:J,type:p,key:_,props:Y,_owner:a},(he!==void 0?he:null)!==null?Object.defineProperty(p,"ref",{enumerable:!1,get:j}):Object.defineProperty(p,"ref",{enumerable:!1,value:null}),p._store={},Object.defineProperty(p._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(p,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(p,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:q}),Object.defineProperty(p,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:G}),Object.freeze&&(Object.freeze(p.props),Object.freeze(p)),p})(e,h,i,(v=$.A)===null?null:v.getOwner(),m,P)}function S(e){L(e)?e._store&&(e._store.validated=1):typeof e=="object"&&e!==null&&e.$$typeof===C&&(e._payload.status==="fulfilled"?L(e._payload.value)&&e._payload.value._store&&(e._payload.value._store.validated=1):e._store&&(e._store.validated=1))}function L(e){return typeof e=="object"&&e!==null&&e.$$typeof===J}var D,I=x,J=Symbol.for("react.transitional.element"),te=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),re=Symbol.for("react.strict_mode"),K=Symbol.for("react.profiler"),ne=Symbol.for("react.consumer"),ie=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),W=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),V=Symbol.for("react.activity"),E=Symbol.for("react.client.reference"),$=I.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,B=Object.prototype.hasOwnProperty,H=Array.isArray,A=console.createTask?console.createTask:function(){return null},o={},u=(I={react_stack_bottom_frame:function(e){return e()}}).react_stack_bottom_frame.bind(I,b)(),s=A(k(b)),l={};U.Fragment=F,U.jsx=function(e,n,i){var t=1e4>$.recentlyCreatedOwnerStacks++;return f(e,n,i,!1,t?Error("react-stack-top-frame"):u,t?A(k(e)):s)},U.jsxs=function(e,n,i){var t=1e4>$.recentlyCreatedOwnerStacks++;return f(e,n,i,!0,t?Error("react-stack-top-frame"):u,t?A(k(e)):s)}})()),U}var y=(se||(se=1,process.env.NODE_ENV==="production"?Q.exports=(function(){if(ae)return M;ae=1;var r=Symbol.for("react.transitional.element"),d=Symbol.for("react.fragment");function g(k,b,j){var f=null;if(j!==void 0&&(f=""+j),b.key!==void 0&&(f=""+b.key),"key"in b)for(var S in j={},b)S!=="key"&&(j[S]=b[S]);else j=b;return b=j.ref,{$$typeof:r,type:k,key:f,ref:b!==void 0?b:null,props:j}}return M.Fragment=d,M.jsx=g,M.jsxs=g,M})():Q.exports=pe()),Q.exports);const Z={x:0,y:0,width:0,height:0,unit:"px"};function le(r,d,g){return Math.min(Math.max(r,d),g)}const ce=(r,d,g,k)=>k==="pixel"?ee(r,d,g):fe(r,d,g),fe=(r,d,g)=>r.unit==="%"?{...Z,...r,unit:"%"}:{unit:"%",x:r.x?r.x/d*100:0,y:r.y?r.y/g*100:0,width:r.width?r.width/d*100:0,height:r.height?r.height/g*100:0};function ee(r,d,g){return r.unit?r.unit==="px"?{...Z,...r,unit:"px"}:{unit:"px",x:r.x?r.x*d/100:0,y:r.y?r.y*g/100:0,width:r.width?r.width*d/100:0,height:r.height?r.height*g/100:0}:{...Z,...r,unit:"px"}}const de=10,O={position:"absolute",outline:"1px solid rgba(0,0,0,0.5)",border:"1px solid rgba(255,255,255,0.5)",width:de,height:de},ye=()=>y.jsxs(x.Fragment,{children:[y.jsx("div",{"data-dir":"s","data-ord":"s",style:{...O,bottom:0,left:"50%",marginBottom:-5,marginLeft:-5,cursor:"s-resize"}}),y.jsx("div",{"data-dir":"n","data-ord":"n",style:{...O,top:0,left:"50%",marginTop:-5,marginLeft:-5,cursor:"n-resize"}}),y.jsx("div",{"data-dir":"w","data-ord":"w",style:{...O,top:"50%",left:0,marginTop:-5,marginLeft:-5,cursor:"w-resize"}}),y.jsx("div",{"data-dir":"e","data-ord":"e",style:{...O,top:"50%",right:0,marginTop:-5,marginRight:-5,cursor:"e-resize"}}),y.jsx("div",{"data-dir":"se","data-ord":"se",style:{...O,bottom:0,right:0,marginBottom:-5,marginRight:-5,cursor:"se-resize"}}),y.jsx("div",{"data-dir":"sw","data-ord":"sw",style:{...O,bottom:0,left:0,marginBottom:-5,marginLeft:-5,cursor:"sw-resize"}}),y.jsx("div",{"data-dir":"nw","data-ord":"nw",style:{...O,top:0,left:0,marginTop:-5,marginLeft:-5,cursor:"nw-resize"}}),y.jsx("div",{"data-dir":"ne","data-ord":"ne",style:{...O,top:0,right:0,marginTop:-5,marginRight:-5,cursor:"ne-resize"}})]}),ge=({area:r,onCropStart:d,showHandles:g,globalAreaStyle:k,customAreaRenderer:b,areaNumber:j})=>{const f={top:`${r.y}${r.unit}`,left:`${r.x}${r.unit}`,width:`${r.width}${r.unit}`,height:`${r.height}${r.unit}`};return y.jsxs("div",{style:{position:"absolute",border:"1px dashed rgba(0,0,0,0.5)",outline:"1px dashed rgba(255,255,255,0.5)",cursor:"move",boxSizing:"border-box",touchAction:"none",...f,...k,...r.areaStyle},onPointerDown:d,"data-wrapper":"wrapper",children:[b?b({...r,areaNumber:j}):null,g?y.jsx(ye,{}):null]})},me=({areas:r})=>y.jsx("table",{style:{position:"absolute",right:0,top:0},children:y.jsx("tbody",{children:r.map((d,g)=>y.jsxs("tr",{children:[y.jsxs("td",{children:["x: ",Math.round(d.x)]}),y.jsxs("td",{children:["y: ",Math.round(d.y)]}),y.jsxs("td",{children:["width: ",Math.round(d.width)]}),y.jsxs("td",{children:["height: ",Math.round(d.height)]}),y.jsxs("td",{children:["unit: ",d.unit]})]},g))})}),ue=(r,d)=>r!==null&&(!!d(r)||ue(r.parentNode,d)),N={capture:!0,passive:!1},xe=["e","w"],be=["n","s"],we=["nw","ne","se","sw"];R.AreaSelector=({maxAreas:r=1/0,unit:d="pixel",minWidth:g=0,minHeight:k=0,debug:b=!1,children:j,areas:f,onChange:S,maxWidth:L,maxHeight:D,wrapperStyle:I,globalAreaStyle:J,customAreaRenderer:te,mediaWrapperClassName:F})=>{const re=x.useRef(null),K=x.useRef(null),[ne,ie]=x.useState(0),[c,T]=x.useState({startClientX:0,startClientY:0,startAreaX:0,startAreaY:0,clientX:0,clientY:0,isResize:!1}),[z,W]=x.useState({areaChangeIndex:0,isChanging:!1}),C=()=>{const o=K.current;if(!o)return{x:0,y:0,width:0,height:0};const{x:u,y:s,width:l,height:e}=o.getBoundingClientRect();return{x:u,y:s,width:l,height:e}},V=x.useCallback(o=>{const u=c.clientX-o.x,s=c.clientY-o.y<c.startAreaY;return u<c.startAreaX?s?"nw":"sw":s?"ne":"se"},[c]),E=x.useCallback(o=>{const u=C();return ee(o,u.width,u.height)},[]),$=x.useCallback(o=>{const u=C(),s=E(o),l=c.clientX-c.startClientX,e=c.clientY-c.startClientY;return s.x=le(c.startAreaX+l,0,u.width-s.width),s.y=le(c.startAreaY+e,0,u.height-s.height),s},[c,E]),B=x.useCallback(o=>{const u=C(),s=V(u),l=E(o),e=c.ord?c.ord:s,n=c.clientX-c.startClientX,i=c.clientY-c.startClientY,t={unit:"px",x:0,y:0,width:0,height:0,isChanging:!0,isNew:!1};s==="ne"?(t.x=c.startAreaX,t.width=n,t.height=Math.abs(i),t.y=c.startAreaY-t.height):s==="se"?(t.x=c.startAreaX,t.y=c.startAreaY,t.width=n,t.height=i):s==="sw"?(t.x=c.startAreaX+n,t.y=c.startAreaY,t.width=Math.abs(n),t.height=i):s==="nw"&&(t.x=c.startAreaX+n,t.width=Math.abs(n),t.height=Math.abs(i),t.y=c.startAreaY+i);const m=(function(P,v,h,w,X=0,p=0,_=h,Y=w){const a={...P};a.y<0&&(a.height=Math.max(a.height+a.y,p),a.y=0),a.x<0&&(a.width=Math.max(a.width+a.x,X),a.x=0);const q=h-(a.x+a.width);q<0&&(a.x=Math.min(a.x,h-X),a.width+=q);const G=w-(a.y+a.height);return G<0&&(a.y=Math.min(a.y,w-p),a.height+=G),a.width<X&&(v!=="sw"&&v!="nw"||(a.x-=X-a.width),a.width=X),a.height<p&&(v!=="nw"&&v!="ne"||(a.y-=p-a.height),a.height=p),a.width>_&&(v!=="sw"&&v!="nw"||(a.x-=_-a.width),a.width=_),a.height>Y&&(v!=="nw"&&v!="ne"||(a.y-=Y-a.height),a.height=Y),a})(t,s,u.width,u.height,g,k,L,D);return we.indexOf(e)>-1?(l.x=m.x,l.y=m.y,l.width=m.width,l.height=m.height):xe.indexOf(e)>-1?(l.x=m.x,l.width=m.width):be.indexOf(e)>-1&&(l.y=m.y,l.height=m.height),l},[c,V,E,g,k,L,D]),H=x.useCallback(o=>{o.preventDefault(),o.stopPropagation();const{isChanging:u,areaChangeIndex:s}=z;if(!u)return;const l=C(),e=f[s];let n;if(T(m=>({...m,clientX:o.clientX,clientY:o.clientY})),n=c.isResize?B(e):$(e),t=n,(i=e).width!==t.width||i.height!==t.height||i.x!==t.x||i.y!==t.y||i.unit!==t.unit){const m=ce(n,l.width,l.height,d);S([...f.slice(0,s),{...m},...f.slice(s+1)])}var i,t},[z,f,c,$,S,d,B]),A=x.useCallback(o=>{o.preventDefault(),o.stopPropagation();const{isChanging:u,areaChangeIndex:s}=z;if(u){W({isChanging:!1,areaChangeIndex:-1}),T({startClientX:0,startClientY:0,startAreaX:0,startAreaY:0,clientX:0,clientY:0,isResize:!1});const l=f[s];S([...f.slice(0,s),{...l,isNew:!1,isChanging:!1},...f.slice(s+1)])}},[z,f,S]);return x.useEffect(()=>(document.addEventListener("pointermove",H,N),document.addEventListener("pointerup",A,N),document.addEventListener("pointercancel",A,N),()=>{document.removeEventListener("pointermove",H,N),document.removeEventListener("pointerup",A,N),document.removeEventListener("pointercancel",A,N)}),[H,A]),y.jsxs("div",{ref:re,style:{position:"relative",display:"inline-block",cursor:"crosshair",boxSizing:"border-box",maxWidth:"100%",touchAction:"none",lineHeight:0,...I},children:[y.jsx("div",{ref:K,onPointerDown:o=>{const u=o.currentTarget;if(u.dataset.wrapper||u.dataset.direction||ue(u,m=>m.dataset?.wrapper))return;o.preventDefault(),o.stopPropagation();const s=C(),l=o.clientX-s.x,e=o.clientY-s.y,n={unit:"px",x:l,y:e,width:0,height:0,isChanging:!0,isNew:!0};T({startClientX:o.clientX,startClientY:o.clientY,startAreaX:l,startAreaY:e,clientX:o.clientX,clientY:o.clientY,isResize:!0}),ie(ne+1);const i=ce(n,s.width,s.height,d);let t;f.length<r?(S(f.concat(i)),t=f.length):(S([...f.slice(0,r-1),i]),t=r-1),W({areaChangeIndex:t,isChanging:!0})},style:{boxSizing:"border-box"},className:F,children:j}),f.map((o,u)=>y.jsx(ge,{area:o,showHandles:!o.isNew,onCropStart:s=>((l,e)=>{l.preventDefault(),l.stopPropagation();const n=C(),i=ee(f[e],n.width,n.height),t=l.target.dataset.ord,m=!!t;let P=l.clientX,v=l.clientY,h=i.x,w=i.y;t&&(t==="ne"||t=="e"?(h=i.x,w=i.y+i.height):t==="se"||t==="s"?(h=i.x,w=i.y):t==="sw"||t=="w"?(h=i.x+i.width,w=i.y):t!=="nw"&&t!="n"||(h=i.x+i.width,w=i.y+i.height),P=h+n.x,v=w+n.y),T({startClientX:P,startClientY:v,startAreaX:h,startAreaY:w,clientX:l.clientX,clientY:l.clientY,isResize:m,ord:t}),W({isChanging:!0,areaChangeIndex:e})})(s,u),globalAreaStyle:J,customAreaRenderer:te,areaNumber:u+1},u)),b?y.jsx(me,{areas:f}):null]})},Object.defineProperty(R,Symbol.toStringTag,{value:"Module"})});
